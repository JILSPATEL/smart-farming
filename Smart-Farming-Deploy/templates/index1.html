<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Farming | Crop Predictor</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <div class="main-wrapper">

        <!-- Result Section (Only shown if result exists) -->
        {% if result %}
        <div class="card result-card">
            <h2 class="result-title">Recommended Crop</h2>
            <div class="result-crop-name">{{ result|replace('[','')|replace(']','')|replace("'", '') }}</div>

            {% set image_map = {
            'apple': 'apple.jpeg',
            'banana': 'banana.jpeg',
            'blackgram': 'blackgram.jpeg',
            'chickpea': 'chickpea.jpeg',
            'coconut': 'coconut.jpeg',
            'coffee': 'coffee.jpeg',
            'cotton': 'cotton.jpg',
            'grapes': 'grapes.jpeg',
            'jute': 'jute.jpg',
            'kidneybeans': 'kidneybeans.jpeg',
            'lentil': 'lentil.jpeg',
            'maize': 'maize.jpeg',
            'mango': 'mango.jpeg',
            'mothbean': 'mothbean.jpeg',
            'mungbean': 'mungbean.jpeg',
            'muskmelon': 'muskmelon.jpeg',
            'orange': 'orange.jpeg',
            'papaya': 'papaya.jpeg',
            'pigeonpeas': 'pigeonpeas.jpg',
            'pomegranate': 'pomegranate.jpeg',
            'rice': 'rice.jpg',
            'watermelon': 'watermelon.jpeg'
            } %}

            {% set clean_result = result|replace('[','')|replace(']','')|replace("'", '')|trim %}

            {% if clean_result in image_map %}
            <img src="{{ url_for('static', filename=image_map[clean_result]) }}" alt="{{ clean_result }}"
                class="crop-image">
            {% else %}
            <!-- Fallback if specific image matching fails, though the previous if/elif block covered it all. 
                      Improves maintainability over the giant if/elif chain. -->
            <p>Image not found for {{ clean_result }}</p>
            {% endif %}

        </div>
        {% else %}
        <!-- Header Section (Only clear when no result or maybe always? Let's keep it clean) -->
        <!-- Actually the user might want to predict again, so form should always be visible. 
              But let's put the header above the form always. 
              Wait, the original code hid nothing. 
              I'll just put the title in the form card or above it. -->
        {% endif %}

        <!-- Form Section -->
        <div class="card">
            <div class="header">
                <h1>Crop Predictor</h1>
                <p>Enter soil and environmental details to get the best crop recommendation.</p>
            </div>

            <form method="post" action="/predict">
                <div class="form-group">
                    <label for="nitrogen">Nitrogen (N)</label>
                    <input type="number" id="nitrogen" name="nitrogen" placeholder="e.g. 90" required step="any">
                </div>

                <div class="form-group">
                    <label for="phosphorous">Phosphorous (P)</label>
                    <input type="number" id="phosphorous" name="phosphorous" placeholder="e.g. 42" required step="any">
                </div>

                <div class="form-group">
                    <label for="potassium">Potassium (K)</label>
                    <input type="number" id="potassium" name="potassium" placeholder="e.g. 43" required step="any">
                </div>

                <div class="form-group">
                    <label for="temperature">Temperature (Â°C)</label>
                    <input type="number" id="temperature" name="temperature" placeholder="e.g. 20.8" required
                        step="any">
                </div>

                <div class="form-group">
                    <label for="humidity">Humidity (%)</label>
                    <input type="number" id="humidity" name="humidity" placeholder="e.g. 82.0" required step="any">
                </div>

                <div class="form-group">
                    <label for="ph">pH Level</label>
                    <input type="number" id="ph" name="ph" placeholder="e.g. 6.5" required step="any">
                </div>

                <div class="form-group">
                    <label for="rainfall">Rainfall (mm)</label>
                    <input type="number" id="rainfall" name="rainfall" placeholder="e.g. 202.9" required step="any">
                </div>

                <div class="submit-btn-container">
                    <button type="submit" class="btn">Predict Crop</button>
                </div>
            </form>
        </div>
    </div>
</body>

</html>